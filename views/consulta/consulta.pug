html
  head
    title Tarjeta con Tabla
    link(rel='stylesheet', href='https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css')
  body
    //.container-fluid.mt-5
    .container.mt-5(style="max-width: 90%;")
      .card.w-100
        .card-body
          .row
            .col-md-6
              h4 Datos Del Paciente
              dl.row
                dt.col-sm-4 Nombre:
                dd.col-sm-8 #{paciente.nombre}
                dt.col-sm-4 Apellido:
                dd.col-sm-8 #{paciente.apellido}
                dt.col-sm-4 Fecha de Nacimiento:
                dd.col-sm-8 #{paciente.fecha_nacimiento.toISOString().split('T')[0]}
                dt.col-sm-4 Documento:
                dd.col-sm-8 #{paciente.documento}
            .col-md-6
              dl.row
                dt.col-sm-4 Género:
                dd.col-sm-8 #{paciente.genero}
                dt.col-sm-4 Estado:
                dd.col-sm-8 #{paciente.estado}
                dt.col-sm-4 Motivo:
                dd.col-sm-8 #{paciente.motivo.replace(/\r?\n/g, ' ')}
          
          h5.mb-4 Alergias Importantes
          if alergias.length !== 0 
            each alergia in alergias
              if alergia.importancia === "alta" || alergia.importancia === "Alta"
                p 
                  span(style="color: red;") [!Alerta!] 
                  b #{alergia.nombre} 
                    span(style="color: green;") (importancia: #{alergia.importancia})
          else 
            p El paciente no tiene Alergias importantes
          hr
          
          h4.mt-4 Evoluciones de la Antencion Actual
          .mb-3
            textarea.form-control(rows='5')
          hr

          h4.mt-4 Diagnósticos de la Atención Actual 
          h5.mt-4 Diagnósticos ingresados 
          table.table.table-sm(id="tablaDiagnosticos")
            thead
              tr 
                th(scope='col') N°
                th(scope='col') Descripción 
                th(scope='col') Estado (Tipo)
            tbody 

          h5.mt-4 Agregar un nuevo diagnóstico
          .row
            .col 
              input.form-control(type='text' id='inputDescripcion' placeholder='Ingrese la descripción' aria-label='Descripción')
            .col
              select.form-select(id='selectEstado' aria-label='Estado')
                option(value='' selected) Estado
                option(value='Preliminar') Preliminar
                option(value='Definitivo') Definitivo
                option(value='Observación') Observación

          button.btn.btn-secondary.mt-4(type='button' onClick="agregarFila()") Agregar Diagnóstico
          hr
  script(src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js")

  // Agrega este script en Pug
script.
  let diagnosticoIndex = 0; // Empieza en 0 ya que no hay datos iniciales

  function agregarFila() {
    // Obtén los valores de los campos de entrada
    const descripcion = document.getElementById('inputDescripcion').value;
    const estado = document.getElementById('selectEstado').value;

    if (!descripcion || !estado) {
      alert("Por favor, complete la descripción y seleccione un estado.");
      return;
    }

    // Incrementa el índice de diagnóstico
    diagnosticoIndex++;

    // Crea una nueva fila
    const fila = document.createElement('tr');

    // Columna de número
    const colNumero = document.createElement('td');
    colNumero.textContent = diagnosticoIndex;

    // Columna de descripción
    const colDescripcion = document.createElement('td');
    colDescripcion.textContent = descripcion;

    // Columna de estado
    const colEstado = document.createElement('td');
    colEstado.textContent = estado;

    // Añadir las columnas a la fila
    fila.appendChild(colNumero);
    fila.appendChild(colDescripcion);
    fila.appendChild(colEstado);

    // Añadir la fila al tbody de la tabla
    document.getElementById('tablaDiagnosticos').querySelector('tbody').appendChild(fila);

    // Limpiar los campos después de agregar
    document.getElementById('inputDescripcion').value = '';
    document.getElementById('selectEstado').value = '';
  }



          
